### 5.1 Difficulty Classification

我们采用了信息熵分析的方法进行了模拟并估计了每个单词的难度。



首先做出如下假定：不妨设所有单词作为 Wordle 答案的概率相等。

具体来说，在 Wordle 游戏中，我们不妨设目前可能成为答案的词集合为 $S$，玩家进行一次单词猜测（设猜测的词为 $\text{word}$）后，根据游戏给出的反馈（每个格子的黄、绿、灰的情况），$S$ 集合将会缩小为它的一个子集 $S'$.

设在所有可能的反馈中 $S$ 缩小成的子集分别为 $S_1,S_2,\cdots,S_k$，由于 $S$ 中的每个词作为答案出现的概率相等，有 $S$ 缩小为子集 $S_i$ 的几率是 $P(S_i)=\cfrac{|S_i|}{|S|}$（这里 $|\cdot|$ 表示集合元素的数量）。

在此时的情况下，为了让一次猜测的价值更高，我们希望两点：

首先， $S_1,\cdots,S_k$ 出现的概率基本均等，也就是 $S_i$ 的大小分布尽量均等；

其次，在出现概率基本均等的基础上，我们希望 $k$ 尽可能大，这样能帮助我们更快地确定答案。

为此我们引入信息熵，有
$$
\text{Entropy}(S,\text{word})=-\sum_{i=1}^k P(S_i)\log P(S_i)
$$
我们注意到，$S_i$ 大小的分布越均等，$k$ 越大，则有 $\text{Entropy}(S,\text{word})$ 越大。

如是，我们有了一种量化猜测 $\text{word}$ 优劣的方法，也得到了一种较为优秀的 Wordle 策略：

每一次，我们对所有可猜测单词计算 $\text{Entropy}(S,\text{word})$，从中选取使得 $\text{Entropy}$ 最大的单词 $\text{word}$ 并猜测之。

经过我们的模拟，在简单模式下，这种策略在 $6$ 次之内可以猜出所有单词，绝大多数单词仅需 $3$ 至 $4$ 次即可猜出。

![GuessTimeDistribution](C:\Users\35721\Desktop\2023-2\美赛\GuessTimeDistribution.png)



在此基础上，由于实际在 Wordle 游戏中，每个词作为 Wordle 答案的概率并不相同，出现频率极低的五字单词更不可能成为 Wordle 的答案，于是我们为每个单词加权，单词 $\text{word}$ 的权重为 $W_{\text{word}}=\log(P_{\text{word}})+C$，其中 $P_{\text{word}}$ 为单词 $\text{word}$ 的词频，$C$ 为一个调整权重的常数，在我们实际模型中为 $20$，词频表同我们在 3.2 中使用过的那个。

于是在上面的讨论中，$S$ 缩小为子集 $S_i$ 的概率为 $P(S_i)=\cfrac{\sum_{\text{word}_i\in S_i}W_{\text{word}_i}}{\sum_{\text{word}\in S}W_{\text{word}}}$，其余内容不变。



有了上述的基础，我们来讨论一道 Wordle 题目的难度。

我们把参与 Wordle 的人群分成三类：

第一类，假设他们恰好使用上面的优秀策略进行游戏；

第二类，假设他们使用较优秀策略进行游戏，每一步，他们会在 $\text{Entropy}$ 最大的前 $5\%$ 中随机选择一个词进行猜测；

第三类，假设他们使用随机策略进行游戏，每一步他们会在剩余的可选单词中随机选择一个进行猜测。

我们假设，后两类人的猜词策略都受到词频的影响。具体而言，当他们随机选择单词时，选择词 $\text{word}$ 的权重为 $W_{\text{word}}$。

我们需要知道这三类人的占比在什么情况下与实际情况拟合的最好。

为此，我们利用第一问中对词语进行的分类，从每类词中选取一个作为训练集进行随机梯度下降，具体方法如下：

首先算出对于训练集中的每个单词，三类人的猜测次数的概率分布，该步使用多次随机进行实现。

接着，对三类人的占比进行随机梯度下降，损失函数仍选用预测的概率分布向量与实际概率分布向的欧几里得距离，即若设预测猜测次数分布向量为 $P=(p_1,\cdots,p_6,p_X)$，实际猜测次数分布向量为 $Q=(q_1,\cdots,q_6,q_X)$，则损失函数 $\mathcal{L}(P,Q) = dist(P,Q)=\sqrt{(p_X-q_X)^2+\sum_{i=1}^6(p_i-q_i)^2}$.

在进行梯度下降后，我们发现，三类人的占比在 $1.407\%$, $56.149\%$, $42.444\%$ 时拟合情况最佳。

接着，我们采取如下的参数分析难度：

- 第一类人所需的猜测次数 $T_1$；
- 第二类人所需的平均猜测次数 $T_2$；
- 第三类人所需的平均猜测次数 $T_3$；
- 第三类人成功猜出单词的概率 $T_4$；

一道题目的难度被定义为 $\text{Diff}(\text{word})=c_1T_1+c_2T_2+c_3T_3-c_4T_4$.

在经过参数的调试后，几个参数最终被定为：$c_1=0.1, c_2=0.5, c_3=0.4, c_4=1.0$.

在对每个单词分难度后，我们按每类中单词的平均难度分类，将类难度分类为了 $1$ 至 $3$ 这 $3$ 个等级。

难度介于 $[0,4.5]$ 的为 $1$ 级难度，即简单难度；介于 $(4.5,5]$ 的为 $2$ 级难度，即中等难度；介于 $(5,+\infty)$ 的为 $3$ 级难度，即困难难度。

结合第二问中建立的神经网络，我们可以对单词进行归类，并根据类难度确定单词本身的难度，由此给词的难度归类。



神经网络对 $\text{eerie}$ 给出的预测分类编号为 $2$，查表可知该类对应的难度为 $2$ 级，即为中等难度。

### 5.2 Model Analyze

在我们的模型中，由于单词的难度直接由其更可能所在的类决定，因此影响单词难度的特性应与影响其所在类的特性相同。

更多地，我们对单词的分类是依据单词猜测次数的分布进行归类，因此影响单词难度的特性应与影响其猜测次数分布的特性相同，这已经在第一个问题中被作答了：即词频、相邻两个字母的组合、字母种类及数量等。



下面对模型预估难度的合理性与准确性进行分析。

在原始数据中，我们猜想，难度应当与所有人猜测次数的平均值与所有人猜测次数的方差相关，且平均值越大，难度越高；方差越大，难度越高。

于是我们对 $15$ 组中平均值、方差与难度的关系进行了拟合，设组中平均值为 $\text{avg}$，方差为 $\text{sqr}$，发现取 $-1.73+1.66\left(1.5\sqrt{\text{avg}}+0.7\sqrt{\text{sqr}}\right)$ 时与难度拟合得较好，如下图：

![ClusterDifficultyAnalysis](C:\Users\35721\Desktop\2023-2\美赛\ClusterDifficultyAnalysis.png)

图中蓝点为按照我们的公式计算方差与平均数所得权值，红点为我们预估的组难度均值，可以从图上看出，除去只有一个单词的编号为 $6$ 的组误差较大外，蓝点和红点重合度较高。

另一方面，我们画出 $-1.73+1.66\left(1.5\sqrt{\text{avg}}+0.7\sqrt{\text{sqr}}\right)$ 关于难度的散点图如下，对其计算 $R^2$ 值得 $0.72$，可知该拟合是较为准确的。

![Test](C:\Users\35721\Desktop\2023-2\美赛\Test.png)

*注：为了保证图的美观性，图中删去了一个明显误差过大的数据点。*

这表明我们对单词的难度预估的确在实际中与猜测次数与猜测次数的方差相关，我们对组中难度的预估是较合理的。



对于单词难度估计的准确性，一方面，这与模型分类的准确性相关，该部分的讨论见第二问。另一方面，这也与同类单词难度是否相似相关，从理论出发，猜测次数曲线相似的单词难度理应相似。我们只需分析按照我们公式预估的难度是否在每一类中相似。

于是，我们对每一组的难度进行了方差分析。

在所有类中，难度方差最大的为编号 $9$ 的类，方差达到了 $0.039$；大多数类中的方差均在 $0.02$ 附近。与之对比，组中平均猜测次数的方差大多在 $0.009$ 附近，这样的方差基本符合预期，即同组中题目难度相似。

每组难度的分布如下图所示，图中横坐标为组编号，纵坐标为难度。

![Sqr](C:\Users\35721\Desktop\2023-2\美赛\Sqr.png)

综上两点，对于模型预测单词的难度我们有较强的自信。



## 6 Task 4: More Data Features

经过对数据集的观察，我们发现数据中存在如下一些有趣的特性。

首先，数据集中的一些数据存在明显错误，下面是我们找出的数据集中存在的部分错误：

1. 部分词语出现多字母、少字母现象，例如 2022-12-16 的 $\text{rprobe}$，2022-11-26 的 $\text{clen}$ 等.
2. 部分词语出现错字母现象，例如 $\text{naive}$ 中的 $\text{i}$ 采用了法语写法 ï 等. 
3. 有数据出现缺位现象，2022-11-30 的结果数量为 $2569$，明显异常.

此外，我们注意到词语被一次猜中的概率分布随时间变化很大，早期（4 月以前）的问题几乎每次都有至少 $0.5\%$ （考虑四舍五入）的人能一次猜中，而到后期只有少数常见词和猜测信息熵较高的词语能有超过 $0.5\%$ 的概率（考虑四舍五入）被人一次性猜中。

我们推测，这可能是由于在早期 Wordle 新玩家群体多，部分玩家会去搜索引擎或社交平台搜寻当日的答案并一次答对，且玩家分享自己一次答对结果的欲望强烈，因此此时每天都有不少玩家能一次猜中；到后期，继续游玩 Wordle 的玩家新玩家占比少，玩家逐渐形成游玩的套路，一次猜中的概率也相应下降了。

另外，我们注意到选用困难模式的玩家比率处于逐日上升的趋势，且这个趋势在年末已经放缓，目前参与困难模式的玩家人数稳定在 $10\%$ 附近。

![HardModePercentage](C:\Users\35721\Desktop\2023-2\美赛\HardModePercentage.png)

### 7 Sensitivity Analysis

